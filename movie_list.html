<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Cineast</title>
		<script src="utils/tailwind.js"></script>
		<script src="utils/alpine.js" defer></script>
		<script src="components/navigation.js"></script>
		<script src="components/movie-card/mc-vertical.js"></script>
		<link rel="stylesheet" href="./css/fonts.css">
		<link rel="stylesheet" href="./css/utils.css">
	</head>
	<body class="font-montserrat" x-data="{items: [1,2,3,4,5,6,7,8,9,10,11,12]}">
		<top-navigation></top-navigation>
		<main class="space-y-16 my-12">
			<div class="space-y-2">
				<div class="mx-auto max-w-7xl p-4 space-y-4">
					<h4 class="text-lg font-semibold">Must Watch</h4>
					<div class="flex items-center space-x-4 overflow-x-auto overflow-y-hidden no-scrollbar relative movie-scroll"></div>
				</div>

				<div class="mx-auto max-w-7xl p-4 space-y-4">
					<h4 class="text-lg font-semibold">Popular</h4>
					<div class="flex items-center space-x-4 overflow-x-auto overflow-y-hidden no-scrollbar relative movie-scroll"></div>
				</div>

				<div class="mx-auto max-w-7xl p-4 space-y-4">
					<h4 class="text-lg font-semibold">Award Winning</h4>
					<div class="flex items-center space-x-4 overflow-x-auto overflow-y-hidden no-scrollbar relative movie-scroll"></div>
				</div>
			</div>
		</main>
		<script src="js/utils.js"></script>
		<script>
			const movies_containers = document.getElementsByClassName("movie-scroll")
			fetch('movies_data/all_movies.json')
				.then(response => response.json())
				.then(data => {
					const movieFiles = data.movies;
					
					for (let i = 0; i < movies_containers.length; i++) {
						const shuffled = movieFiles.slice();
						for (let k = shuffled.length - 1; k > 0; k--) {
							const r = Math.floor(Math.random() * (k + 1));
							[shuffled[k], shuffled[r]] = [shuffled[r], shuffled[k]];
						}
						const randomMovies = shuffled.slice(0, Math.min(15, shuffled.length));
						randomMovies.forEach(movie => {
							fetch(`movies_data/${movie}`)
							.then(response => response.json())
							.then(movieData => {
								const movieCard = document.createElement("mc-vertical");
								movieCard.setAttribute("image", movieData.Poster_OMDb || movieData.Poster_TMDb);
								movieCard.setAttribute("name", movieData.Title);
								movieCard.setAttribute("year", movieData.Year);
								movieCard.setAttribute("genre", movieData.Genre);
								movieCard.setAttribute("duration", movieData.Runtime);
								movieCard.setAttribute("rating", movieData.imdbRating);
								movieCard.setAttribute("description", movieData.Plot);
								movieCard.setAttribute("link", `movie_info.html?id=${movie}`);
								movies_containers[i].appendChild(movieCard);
							});
						});
					}
				})
		</script>
	</body>
</html>